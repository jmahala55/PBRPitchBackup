<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pitching Performance Report - {{ pitcher_name }}</title>
    <style>
        @page {
            size: A4 landscape;
            margin: 0.4in;
        }
        
        body {
            font-family: 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: white;
            color: #2c3e50;
            font-size: 11px;
            line-height: 1.5;
        }
        
        .logo-placeholder {
            width: 320px;
            height: 120px;
            background: url('static/pbr.png') center/contain no-repeat;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
            margin-left: -75px;
        }
        
        /* Player Info Bar */
        .player-info {
            display: grid;
            grid-template-columns: 1fr 2fr 1fr;
            align-items: center;
            margin: 0px 0;
            padding: 20px 30px;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            color: white;
            border-radius: 10px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.25);
        }

        .player-info-left {
            display: flex;
            justify-content: flex-start;
            align-items: center;
        }

        .player-info-center {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .player-info-right {
            display: flex;
            justify-content: flex-end;
            align-items: center;
        }
        
        .player-name {
            font-size: 26px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }
        .player-name-group {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .player-subtitle {
            font-size: 10px;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.75);
            margin-top: 4px;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }
        .player-subtitle::after {
            content: "";
            display: block;
            width: 100px;
            height: 1.5px;
            margin: 6px auto 0;
            background-color: rgba(255, 255, 255, 0.25);
            border-radius: 2px;
        }
        
        .date-info {
            font-size: 14px;
            font-weight: 600;
            color: white;
            padding: 6px 14px;
            background: linear-gradient(135deg, #1f2937, #4b5563);
            border-radius: 9999px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
            letter-spacing: 1px;
            text-transform: uppercase;
        }
        
        /* Movement Plot Page Styles */
        .movement-plot-page {
            page-break-before: always;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 0;
            margin: 0;
        }
        


        .movement-plot-header {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            color: white;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-size: 16px;
            border-radius: 8px;
            font-weight: 700;
            margin-bottom: 15px;
            text-shadow: 0 1px 3px rgba(0,0,0,0.5);
    width: 100%;
    max-width: none;
    padding: 18px 25px;
}
        
        .movement-plot-container {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            padding: 10px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            width: calc(100% - 20px);
            max-width: none;
        }
        
        .movement-plot-svg {
            width: 100%;
            height: auto;
            max-width: none;
        }
        
        .movement-plot-description {
            margin-top: 15px;
            padding: 12px;
            background: #f8fafc;
            border-left: 4px solid #3498db;
            border-radius: 0 6px 6px 0;
            font-size: 11px;
            color: #2c3e50;
            line-height: 1.5;
        }
        
        /* Comparison Legend - Dynamic sizing */
        .comparison-legend {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            font-size: 10px;
        }
        
        .comparison-legend.compact {
            padding: 8px 12px;
            margin: 10px 0;
            font-size: 8px;
        }
        
        .legend-title {
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .legend-title.compact {
            margin-bottom: 6px;
            letter-spacing: 0.5px;
            font-size: 9px;
        }
        
        .legend-item {
            display: inline-block;
            margin-right: 20px;
            margin-bottom: 5px;
        }
        
        .legend-item.compact {
            margin-right: 15px;
            margin-bottom: 3px;
        }
        
        .legend-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 5px;
            vertical-align: middle;
        }
        
        .legend-indicator.compact {
            width: 10px;
            height: 10px;
            margin-right: 4px;
        }
        
        .above-average {
            background: #10b981;
            color: white;
        }
        
        .below-average {
            background: #ef4444;
            color: white;
        }
        
        /* Enhanced Summary Section - Dynamic sizing */
        .summary-section {
            background: linear-gradient(135deg, #f8fafc 0%, #ffffff 100%);
            border: 1px solid #e2e8f0;
            margin: 25px 0;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }
        
        .summary-section.compact {
            margin: 15px 0;
        }
        
        .summary-header {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            color: white;
            margin: 0;
            font-size: 18px;
            text-align: center;
            padding: 18px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: 0 1px 3px rgba(0,0,0,0.5);
        }
        
        .summary-header.compact {
            font-size: 14px;
            padding: 12px;
            letter-spacing: 1px;
        }
        
        .stats-container {
            padding: 25px;
        }
        
        .stats-container.compact {
            padding: 15px;
        }
        
        /* Summary Table Styling with Comparisons - Dynamic sizing */
        .summary-table {
            width: 100%;
            border-collapse: collapse;
            margin: 0;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            font-size: 10px;
        }
        
        .summary-table.compact {
            font-size: 8px; /* Smaller font for many pitch types */
        }
        
        .summary-table th {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            color: white;
            padding: 12px 8px;
            text-align: center;
            font-weight: 700;
            font-size: 9px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border: none;
            text-shadow: 0 1px 2px rgba(0,0,0,0.5);
        }
        
        .summary-table.compact th {
            padding: 6px 4px; /* Reduced padding for compact mode */
            font-size: 7px;
            letter-spacing: 0.3px;
            line-height: 1.2;
        }
        
        .summary-table td {
            padding: 10px 8px;
            text-align: center;
            border-bottom: 1px solid #f1f5f9;
            font-weight: 500;
            font-size: 9px;
        }
        
        .summary-table.compact td {
            padding: 4px 3px; /* Very compact for many pitch types */
            font-size: 7px;
            line-height: 1.2;
        }
        
        .summary-table tr:nth-child(even) {
            background: linear-gradient(135deg, #f8fafc 0%, #ffffff 100%);
        }
        
        .summary-table tr:nth-child(odd) {
            background: white;
        }
        
        .pitch-type-name {
            font-weight: 700 !important;
            color: #1e293b !important;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 10px !important;
            background: rgba(26,26,26,0.1) !important;
            border-radius: 6px;
        }
        
        .pitch-count {
    font-weight: 750 !important;
    color: #6366f1 !important;
    background: rgba(99,102,241,0.1) !important;
    border-radius: 4px;
    font-size: 8px !important;  /* <-- Add this */
}
.level-badge-static {
    background: #f1f5f9 !important;
    color: #64748b !important;
    border: 1px solid #e2e8f0;
}
        
        /* Comparison styling */
        .comparison-cell {
            position: relative;
            padding: 8px 6px !important;
        }
        
        .player-value {
            display: block;
            font-weight: 700;
            font-size: 11px;
            margin-bottom: 2px;
        }
        
        .college-value {
            display: block;
            font-size: 8px;
            color: #64748b;
            font-weight: 500;
        }
        
              .comparison-indicator {
    position: absolute;
    top: 2px;
    right: 2px;
    width: 14px;
    height: 14px;
    border-radius: 50%;
    font-size: 10px;
    font-weight: bold;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 3px 8px rgba(0,0,0,0.25);
    border: 1px solid rgba(255,255,255,0.2);
}

.comparison-indicator::before {
    content: "↑";
    margin-top: -2px;  /* Move arrow up by 1px */
}

.comparison-indicator.above-average {
    background: linear-gradient(135deg, #10b981, #059669);
    color: white;
}

.comparison-indicator.below-average {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    color: white;
}

.comparison-indicator.below-average::before {
    content: "↓";
    margin-top: -2px;  /* Move arrow up by 1px */
}


        
.metric-value {
    color: #000000 !important;
    font-weight: 700 !important;
}
        .velocity-cell {
            color: #e11d48 !important;
        }
        
        .spin-cell {
            color: #7c3aed !important;
        }
        
        .ivb-cell, .hb-cell {
            color: #059669 !important;
        }
        
        .release-cell, .extension-cell {
            color: #64748b !important;
        }
        
        /* Enhanced Details Section - Dynamic spacing based on pitch count */
        .details-section {
            margin: 30px 0;
        }
        
        .details-section.first-page {
            margin: 15px 0 10px 0; /* Reduced margins for first page */
        }
        
        .section-header {
            color: white;
            font-size: 18px;
            margin-bottom: 20px;
            padding: 18px 25px;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            border-radius: 10px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 2px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.25);
            text-shadow: 0 1px 3px rgba(0,0,0,0.5);
        }
        
        .section-header.compact {
            font-size: 16px;
            margin-bottom: 15px;
            padding: 12px 20px; /* Reduced padding for compact mode */
        }
        
/* Ultra-Clean Table - Dynamic sizing */
.pitch-table {
    width: 100%;
    border-collapse: collapse;
    margin: 20px 0;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    font-size: 10px;
}

.pitch-table.compact {
    margin: 8px 0; /* Reduced margins for compact mode */
    font-size: 9px; /* Smaller font for more rows */
}

.pitch-table th {
    background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
    color: white;
    padding: 12px 10px; /* Slightly reduced from 14px 12px */
    text-align: center;
    font-weight: 700;
    font-size: 9px;
    text-transform: uppercase;
    letter-spacing: 1px;
    border: none;
    text-shadow: 0 1px 2px rgba(0,0,0,0.5);
}

.pitch-table.compact th {
    padding: 8px 6px; /* Slightly reduced padding for compact mode */
    font-size: 8px;
}

.pitch-table td {
    padding: 12px 10px; /* Slightly reduced from 14px 12px */
    text-align: center;
    border: none;
    font-size: 10px;
    font-weight: 500;
    border-bottom: 1px solid #f1f5f9;
}

.pitch-table.compact td {
    padding: 7px 5px; /* Slightly reduced padding for compact mode */
    font-size: 9px;
}

.pitch-table tr:nth-child(even) {
    background: linear-gradient(135deg, #f8fafc 0%, #ffffff 100%);
}

.pitch-table tr:nth-child(odd) {
    background: white;
}

/* Enhanced Pitch Numbers - Dynamic sizing */
.pitch-number {
    background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%) !important;
    color: white !important;
    font-weight: 700;
    border-radius: 50%;
    width: 26px; /* Slightly reduced from 28px */
    height: 26px; /* Slightly reduced from 28px */
    line-height: 26px; /* Slightly reduced from 28px */
    margin: 0 auto;
    font-size: 10px; /* Kept the same */
    box-shadow: 0 3px 8px rgba(0,0,0,0.3);
    text-shadow: 0 1px 2px rgba(0,0,0,0.5);
}

.pitch-table.compact .pitch-number {
    width: 21px; /* Slightly reduced from 22px */
    height: 21px; /* Slightly reduced from 22px */
    line-height: 21px; /* Slightly reduced from 22px */
    font-size: 9px; /* Kept the same */
}

.pitch-type {
    font-weight: 700;
    color: #334155;
    text-transform: uppercase;
    font-size: 9px;
    letter-spacing: 0.5px;
    padding: 4px 8px;
    border-radius: 6px;
    background: rgba(26,26,26,0.1);
}
        
.velocity-high,
.velocity-medium,
.velocity-low {
    color: white;
    font-weight: 700;
    background: linear-gradient(135deg, #059669 0%, #10b981 100%);
    border-radius: 6px;
    padding: 4px 8px;
    box-shadow: 0 2px 6px rgba(5,150,105,0.3);
}

        
        /* Enhanced Break Value Styling */
        .break-positive {
            color: #059669;
            font-weight: 700;
            background: rgba(16,185,129,0.1);
            padding: 3px 6px;
            border-radius: 4px;
        }
        
        .break-negative {
            color: #dc2626;
            font-weight: 700;
            background: rgba(220,38,38,0.1);
            padding: 3px 6px;
            border-radius: 4px;
        }
        
        .spin-rate-high {
            color: #7c3aed;
            font-weight: 700;
            background: rgba(124,58,237,0.1);
            padding: 3px 6px;
            border-radius: 4px;
        }
        
        .footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 6px 20px;
            background: #1a1a1a;
            color: rgba(255, 255, 255, 0.85);
            font-size: 10px;
            position: relative;
            border-top: 1px solid rgba(255,255,255,0.08);
            box-shadow: 0 -1px 3px rgba(0, 0, 0, 0.2);
            height: 20px;
            margin: 0;
        }

        .footer-logo {
            height: 24px;
            width: auto;
            filter: drop-shadow(0 1px 2px rgba(0,0,0,0.3));
        }

        .footer-text {
            font-weight: 600;
            letter-spacing: 0.5px;
            text-transform: uppercase;
            font-size: 10px;
        }

        .footer-date {
            font-size: 10px;
            opacity: 0.8;
        }

/* Replace your existing .explanation-label CSS with this Option 3 implementation */

/* Replace your existing .explanation-label CSS with this Option 3 implementation */
.layout-with-arrow {
    display: flex;
    align-items: center;
    gap: 15px;
}

.arrow-explanation {
    display: flex;
    align-items: center;
    gap: 10px;
}

.arrow-simple {
    font-size: 16px;
    color: #3498db;
    font-weight: bold;
}

.explanation-text {
    background: #f8fafc;
    border: 1px solid #e2e8f0;
    border-radius: 6px;
    padding: 8px 10px;
    font-size: 8px;
    line-height: 1.3;
    max-width: 120px;
}

.explanation-label {
    font-weight: 600;
    color: #1e293b;
    display: block;
    margin-bottom: 2px;
}

.explanation-value {
    color: #64748b;
    font-size: 7px;
    display: block;
}


.badge-container {
    position: relative;
}

.info-panel {
    position: absolute;
    top: 0;
    left: 120px;  /* shift it to the right of the badge */
    width: 180px;
        background: rgba(255, 255, 255, 0.98);
    border: 2px solid #3498db;
    border-radius: 8px;
    padding: 12px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        backdrop-filter: blur(8px);
    /* other styles stay the same */
}



/* Compact version for smaller panels */
.info-panel-compact {
    right: -200px !important;
    width: 130px !important;
    padding: 8px !important;
    font-size: 9px !important;
}

.info-panel-compact .info-item {
    padding: 4px 0 !important;
    font-size: 9px !important;
}

.info-panel-compact .info-label {
    font-size: 8px !important;
    letter-spacing: 0.3px !important;
}

.info-panel-compact .info-value {
    font-size: 9px !important;
}

.info-item {
    display: flex;
    justify-content: space-between;
    padding: 6px 0;
    border-bottom: 1px solid #f1f5f9;
    font-size: 11px;
    align-items: center;
}

.info-item:last-child {
    border-bottom: none;
}

.info-label {
    font-weight: 600;
    color: #64748b;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    font-size: 10px;
}

.info-value {
    font-weight: 700;
    color: #1a1a1a;
    font-size: 11px;
}

/* Print-friendly adjustments */
@media print {
    .info-panel, .info-panel-compact {
        position: static;
        margin-top: 10px;
        width: 100%;
        max-width: 200px;
        right: auto;
        top: auto;
    }
}

        @media print {
            @page {
                margin: 0.4in;
                size: A4 landscape;
            }
            
            .footer {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
            }
            
            body {
                margin: 0;
                padding: 0;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            
            .header, .summary-section, .footer {
                break-inside: avoid;
                page-break-inside: avoid;
            }
            
            /* Movement plot page */
            .movement-plot-page {
                break-inside: avoid;
                page-break-inside: avoid;
            }
            
            /* Each details section (pitch type) should be on its own page */
            .details-section {
                break-inside: avoid;
                page-break-inside: avoid;
            }
            
            /* Prevent individual pitch comparison cards from breaking */
            .pitch-comparison-card {
                break-inside: avoid;
                page-break-inside: avoid;
                margin-bottom: 20px;
            }
            
            .pitch-table {
                font-size: 9px;
                break-inside: auto;
                page-break-inside: auto;
            }
            
    .pitch-table th,
    .pitch-table td {
        padding: 8px 6px;  /* Reduced from 10px 8px for print */
    }
            
            .stat-item:hover,
            .pitch-table tr:hover {
                transform: none;
                background: inherit !important;
            }
            
            
            /* Ensure section headers don't get orphaned */
            .section-header {
                break-after: avoid;
                page-break-after: avoid;
            }
        }
        
        /* Additional PDF-specific styles */
        .pitch-comparison-card {
            min-height: 400px; /* Ensure cards have enough space for all content */
            box-sizing: border-box;
        }
        
        /* Page break utility */
        .page-break {
            page-break-before: always;
        }
        
        /* Performance Badges */
        .performance-badge {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 8px;
            font-weight: 600;
            text-transform: uppercase;
            margin-left: 4px;
        }
        
        .badge-excellent {
            background: linear-gradient(135deg, #059669 0%, #10b981 100%);
            color: white;
        }
        
        .badge-good {
            background: linear-gradient(135deg, #ea580c 0%, #f97316 100%);
            color: white;
        }
        
        .badge-needs-work {
            background: linear-gradient(135deg, #dc2626 0%, #ef4444 100%);
            color: white;
        }
        
        /* Subtle animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Updated Multi-Level Comparison Styles */
        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .pitch-comparison-card {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }
        
        .pitch-card-header {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            color: white;
            padding: 10px 15px;
            margin: -20px -20px 15px -20px;
            border-radius: 10px 10px 0 0;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 11px;
        }
        
        /* Two-column layout for metrics */
        .metrics-grid {
            display: grid;
            grid-template-columns: 1fr 2px 1fr;
            gap: 15px;
            align-items: start;
        }
        
        .metrics-column {
            display: flex;
            flex-direction: column;
            gap: 15px;
            padding-left: 20px; /* Only shift college comparison content slightly right */
        }
        
        .vertical-divider {
            background: linear-gradient(to bottom, transparent, #e2e8f0, transparent);
            width: 2px;
            min-height: 200px;
            margin: 0 10px;
        }
        
        .metric-comparison {
            padding-bottom: 12px;
            border-bottom: 1px solid #f1f5f9;
        }
        
        .metric-comparison:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }
        
        .metric-name {
            font-weight: 600;
            color: #1e293b;
            font-size: 10px;
            margin-bottom: 6px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .player-value-large {
            font-size: 16px;
            font-weight: 700;
            color: #1a1a1a;
            margin-bottom: 8px;
        }
        
        .level-comparisons {
            display: flex;
            gap: 8px;
            align-items: center;
        }
        
        .level-badge {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 6px 8px;
            border-radius: 6px;
            font-size: 8px;
            min-width: 50px;
            text-align: center;
        }
        
        .level-badge.above {
            background: linear-gradient(135deg, #059669 0%, #10b981 100%);
            color: white;
        }
        
        .level-badge.below {
            background: linear-gradient(135deg, #dc2626 0%, #ef4444 100%);
            color: white;
        }
        
        .level-badge.neutral {
            background: #f1f5f9;
            color: #64748b;
        }
        
        .level-name {
            font-weight: 700;
            margin-bottom: 2px;
        }
        
        .percentage-diff {
            font-size: 7px;
            opacity: 0.9;
        }

/* PITCH LOCATION PAGE - FIXED TO MATCH MOVEMENT PAGE LAYOUT */
.pitch-location-page {
    page-break-before: always;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    min-height: 100vh;
    padding: 20px;
    margin: 0;
    box-sizing: border-box;
}

.pitch-location-header {
    background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
    color: white;
    text-transform: uppercase;
    letter-spacing: 2px;
    font-size: 16px;
    border-radius: 8px;
    font-weight: 700;
    margin-bottom: 15px;
    text-shadow: 0 1px 3px rgba(0,0,0,0.5);
    width: 100%;
    max-width: none;
    padding: 18px 25px;
    text-align: left;
}

.pitch-location-container {
    background: white;
    border: 2px solid #e2e8f0;
    border-radius: 10px;
    padding: 10px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    width: 100%;
    max-width: 100%;
    box-sizing: border-box;
}

.pitch-location-content {
    display: flex;
    gap: 20px;
    align-items: flex-start;
    justify-content: space-between;
    margin-bottom: 5px;
    margin-top: 30px;
    min-height: 450px;
}

.pitch-location-plot {
    flex: 1;
    max-width: 50%;
}

.pitch-location-plot svg {
    width: 100%;
    height: auto;
    max-width: 100%;
}

.pitch-location-info {
    flex: 1;
    max-width: 50%;
    display: flex;
    flex-direction: column;
    gap: 8px;
    padding-right: 15px;
    box-sizing: border-box;
}

/* IMPROVED ZONE TABLE CONTAINER - DYNAMIC HEIGHT */
.zone-table-container {
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: 6px;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    width: 100%;
    margin: 0;
    height: 400px; /* Default height */
    display: flex;
    flex-direction: column;
}

/* Dynamic sizing based on number of pitch types */
.zone-table-container.few-pitches {
    height: 350px; /* 1-3 pitch types */
}

.zone-table-container.normal-pitches {
    height: 400px; /* 4-5 pitch types */
}

.zone-table-container.many-pitches {
    height: 450px; /* 6+ pitch types */
}

/* IMPROVED ZONE TABLE */
.zone-table-compact {
    width: 100%;
    border-collapse: collapse;
    font-size: 13px; /* Increased base font size */
    margin: 0;
    height: 100%;
}

/* IMPROVED TABLE HEADERS WITH BETTER PROPORTIONS */
.zone-table-compact th {
    background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
    color: white;
    padding: 16px 6px; /* Increased vertical padding */
    text-align: center;
    font-weight: 700;
    font-size: 11px; /* Increased from 10px */
    text-transform: uppercase;
    letter-spacing: 0.5px;
    border: none;
    text-shadow: 0 1px 2px rgba(0,0,0,0.5);
    line-height: 1.2;
    vertical-align: middle;
}

/* UPDATED COLUMN WIDTHS FOR BETTER PROPORTIONS */
.pitch-header-compact {
    text-align: center !important;
    width: 26%; /* Increased from 22% for bigger conference names */
    font-size: 12px !important; /* Larger font for pitch type */
}

.zone-header-compact {
    width: 16%; /* Slightly reduced */
}

.college-header-compact {
    width: 16%; /* Slightly reduced */
}

.diff-header-compact {
    width: 12%; /* Reduced from 14% */
}

.visual-header-compact {
    width: 30%; /* Slightly increased from 28% */
}

/* IMPROVED TABLE BODY WITH DYNAMIC ROW HEIGHT */
.zone-table-compact td {
    text-align: center;
    border-bottom: 1px solid #f1f5f9;
    font-weight: 500;
    vertical-align: middle;
    font-size: 12px; /* Increased from 11px */
    line-height: 1.3;
}

/* Dynamic padding based on number of rows */
.zone-table-compact.few-rows td {
    padding: 18px 6px; /* More padding for fewer rows */
}

.zone-table-compact.normal-rows td {
    padding: 14px 6px; /* Normal padding */
}

.zone-table-compact.many-rows td {
    padding: 10px 6px; /* Less padding for many rows */
}

.zone-table-compact tr:nth-child(even) {
    background: #f8fafc;
}

.zone-table-compact tr:nth-child(odd) {
    background: white;
}

/* OVERALL ROW - OPTION 5: LIGHT PROFESSIONAL */
.overall-compact {
    background: linear-gradient(135deg, #e2e8f0 0%, #cbd5e1 100%) !important;
    color: #1e293b !important;
    border: 2px solid #64748b !important;
}

.overall-compact td {
    color: #1e293b !important;
    font-weight: 700 !important;
    border-bottom: 1px solid #94a3b8 !important;
}

/* IMPROVED TEXT ELEMENTS - LARGER AND MORE READABLE */
.pitch-label-compact {
    font-size: 10px; /* Increased from 8px */
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.2px; /* Slightly increased */
    color: #1e293b;
    line-height: 1.2;
    display: block;
    margin: 0;
}

.overall-compact .pitch-label-compact {
    color: #1e293b;
    font-size: 11px; /* Even larger for overall row */
    font-weight: 700;
}

.zone-pct-compact {
    font-size: 10px; /* Increased from 8px */
    font-weight: 700;
    color: #059669;
    background: rgba(5, 150, 105, 0.1);
    padding: 3px 4px; /* Increased padding */
    border-radius: 3px;
    display: inline-block;
    line-height: 1.2;
    min-width: 35px; /* Ensure consistent width */
}

.overall-compact .zone-pct-compact {
    background: rgba(5, 150, 105, 0.2) !important;
    color: #065f46 !important;
    font-size: 11px; /* Larger for overall */
}

.overall-compact .college-pct-compact {
    background: rgba(245, 158, 11, 0.2) !important;
    color: #92400e !important;
}

.college-pct-compact {
    font-size: 9px; /* Increased from 7px */
    font-weight: 600;
    color: #f59e0b;
    background: rgba(245, 158, 11, 0.1);
    padding: 3px 4px; /* Increased padding */
    border-radius: 3px;
    display: inline-block;
    line-height: 1.2;
    min-width: 35px; /* Ensure consistent width */
}

.diff-value-compact {
    font-size: 9px; /* Increased from 7px */
    font-weight: 700;
    padding: 3px 4px; /* Increased padding */
    border-radius: 3px;
    display: inline-block;
    line-height: 1.2;
    min-width: 30px; /* Ensure consistent width */
}

.diff-value-compact.positive-compact {
    color: #059669;
    background: rgba(5, 150, 105, 0.1);
}

.diff-value-compact.negative-compact {
    color: #dc2626;
    background: rgba(220, 38, 38, 0.1);
}

/* IMPROVED VISUAL COMPARISON */
.comparison-compact {
    display: flex;
    align-items: center;
    gap: 4px; /* Increased gap */
    justify-content: center;
    padding: 2px;
}

.bar-compact {
    position: relative;
    width: 40px; /* Increased from 35px */
    height: 8px; /* Increased from 7px */
    background: #e5e7eb;
    border-radius: 4px;
    border: 1px solid #d1d5db;
    overflow: hidden;
    box-sizing: border-box;
}

.player-bar-compact {
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    background: linear-gradient(135deg, #059669 0%, #10b981 100%);
    border-radius: 3px;
    min-width: 0;
    max-width: 100%;
    box-sizing: border-box;
}

.college-line-compact {
    position: absolute;
    top: -1px;
    width: 2px;
    height: 10px; /* Increased from 9px */
    background: #f59e0b;
    z-index: 10;
    transform: translateX(-1px);
}

/* IMPROVED ARROWS */
.arrow-compact {
    position: relative;
    width: 14px;
    height: 14px;
    border-radius: 50%;
    font-size: 10px;
    font-weight: bold;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    box-shadow: 0 3px 8px rgba(0,0,0,0.25);
    border: 1px solid rgba(255,255,255,0.2);
}

.arrow-compact::before {
    margin-top: -2px; /* Move arrow up by 2px */
}

.arrow-up-compact {
    background: linear-gradient(135deg, #10b981, #059669);
    color: white;
}

.arrow-up-compact::before {
    content: "↑";
    margin-top: -2px;
}

.arrow-down-compact {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    color: white;
}

.arrow-down-compact::before {
    content: "↓";
    margin-top: -2px;
}

.pitch-location-description {
    margin-top: 15px;
    padding: 12px;
    background: #f8fafc;
    border-left: 4px solid #3498db;
    border-radius: 0 6px 6px 0;
    font-size: 11px;
    color: #2c3e50;
    line-height: 1.5;
}

/* RESPONSIVE SCALING */
@media print {
    .zone-table-compact {
        font-size: 11px;
    }
    
    .zone-table-compact th {
        padding: 12px 4px;
        font-size: 10px;
    }
    
    .zone-table-compact td {
        padding: 10px 4px;
        font-size: 10px;
    }
    
    .pitch-label-compact {
        font-size: 9px;
    }
    
    .zone-pct-compact {
        font-size: 9px;
    }
}

.pitch-location-description {
    margin-top: 15px; /* MATCHED TO MOVEMENT PAGE */
    padding: 12px;
    background: #f8fafc;
    border-left: 4px solid #3498db;
    border-radius: 0 6px 6px 0;
    font-size: 11px;
    color: #2c3e50;
    line-height: 1.5;
}

.glossary-page {
    page-break-before: always;
    padding: 20px 0;
}

.glossary-two-column {
    column-count: 2;
    column-gap: 30px;
    column-rule: 2px solid #e2e8f0;
    padding: 0 20px 20px 20px;
}

.glossary-header {
    background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
    color: white;
    text-align: center;
    padding: 20px;
    margin: 0 0 25px 0;
    font-size: 20px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 2px;
    text-shadow: 0 1px 3px rgba(0,0,0,0.5);
    border-radius: 10px;
}

.term-entry {
    break-inside: avoid;
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 1px solid #f1f5f9;
}

.term-entry:last-child {
    border-bottom: none;
}

.term-name {
    font-weight: 700;
    color: #1e293b;
    font-size: 12px;
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-bottom: 6px;
}

.term-definition {
    color: #475569;
    font-size: 10px;
    line-height: 1.5;
    margin-bottom: 4px;
}

.term-unit {
    color: #3498db;
    font-size: 9px;
    font-weight: 600;
    font-style: italic;
}

/* ADD THESE STYLES TO THE <style> SECTION OF YOUR pitcher_report.html FILE */

/* Thunder Page Styles */
.thunder-page {
    page-break-before: always;
    padding: 20px 0;
    min-height: 100vh;
}


.thunder-header {
    background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
    color: white;
    text-align: center;
    padding: 20px;
    margin: 0 0 25px 0;
    font-size: 20px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 2px;
    text-shadow: 0 1px 3px rgba(0,0,0,0.5);
    border-radius: 10px;
}

.thunder-container {
    padding: 0 20px;
}

/* Thunder Explanation */
.thunder-explanation-top {
    background: #f0f9f0;
    border: 2px solid black;
    border-radius: 8px;
    padding: 15px;
    margin-bottom: 25px;
}

.thunder-explanation-content {
    text-align: center;
}

.thunder-explanation-text h3 {
    font-size: 16px;
    font-weight: 700;
    color: #228B22;
    margin: 0 0 8px 0;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.thunder-explanation-text p {
    font-size: 12px;
    color: #2d5a2d;
    margin: 0;
    line-height: 1.4;
}

/* Thunder Section Titles */
.thunder-section-title {
    font-size: 16px;
    font-weight: 700;
    color: #1e293b;
    margin: 0 0 15px 0;
    text-transform: uppercase;
    letter-spacing: 1px;
    padding-bottom: 8px;
    border-bottom: 2px solid #228B22;
}

/* Thunder Stats Table */
.thunder-stats-section {
    margin-bottom: 30px;
}

.thunder-stats-table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 25px;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 4px 15px rgba(0,0,0,0.08);
    font-size: 11px;
}

.thunder-stats-table th {
    background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
    color: white;
    padding: 12px 8px;
    text-align: center;
    font-weight: 700;
    font-size: 10px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    border: none;
    text-shadow: 0 1px 2px rgba(0,0,0,0.5);
}

.thunder-stats-table td {
    padding: 10px 8px;
    text-align: center;
    border-bottom: 1px solid #f1f5f9;
    font-weight: 500;
}

/* Average Row Styling */
.avg-row {
    background: #f8fafc;
}

.avg-row:hover {
    background: #e2e8f0;
}

/* Thunder Row Styling */
.thunder-row {
    background: linear-gradient(135deg, #228B22 0%, #32CD32 100%);
    color: white;
    border-bottom: 3px solid #1a6b1a;
}

.thunder-row td {
    color: white;
    font-weight: 600;
    border-bottom: 1px solid #1a6b1a;
}

.thunder-row:hover {
    background: linear-gradient(135deg, #1e7a1e 0%, #2db82d 100%);
}

/* Cell Type Styling */
.row-type-cell {
    font-weight: 700;
    font-size: 10px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    border-right: 2px dashed #ccc;
}

.avg-type {
    color: #475569;
    background: rgba(71,85,105,0.1);
    border-radius: 4px;
}

.thunder-type {
    background: rgba(255,255,255,0.2);
    border-radius: 4px;
}

.pitch-type-cell {
    font-weight: 700;
    font-size: 10px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    background: rgba(26,26,26,0.05);
    border-radius: 4px;
}

.thunder-pitch {
    background: rgba(255,255,255,0.2) !important;
}

.count-cell {
    font-weight: 600;
    border-right: 2px dashed #ccc;
}

.thunder-count {
    background: rgba(255,255,255,0.1);
    border-radius: 4px;
}

.metric-cell {
    font-weight: 500;
    font-size: 10px;
}

.thunder-metric {
    font-weight: 600;
}

.action-cell {
    font-weight: 700;
    font-size: 11px;
    background: rgba(59,130,246,0.1);
    border-radius: 4px;
    color: #1e40af;
    border-left: 2px dashed #ccc;
}

.thunder-action {
    background: rgba(255,255,255,0.2) !important;
    color: white !important;
    font-weight: 700;
}

/* Movement and Release Plot Sections */
.thunder-movement-section,
.thunder-release-section {
    margin-bottom: 2px;
}

.thunder-movement-container,
.thunder-release-container {
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: 8px;
    padding: 5px;
    text-align: center;
}

/* Thunder Details Section */
.thunder-details-section {
    background: #f8fafc;
    border: 1px solid #e2e8f0;
    border-radius: 8px;
    padding: 5px;
    margin-top: 2px;
}

.thunder-details-content {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    font-size: 10px;
    line-height: 1.5;
}

.thunder-details-column h4 {
    font-size: 12px;
    font-weight: 700;
    color: #228B22;
    margin: 0 0 8px 0;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.thunder-details-column p {
    margin: 0 0 12px 0;
    color: #475569;
}

.thunder-details-column ul {
    margin: 0;
    padding-left: 16px;
    color: #475569;
}

.thunder-details-column li {
    margin-bottom: 4px;
}

.thunder-details-column strong {
    color: #228B22;
    font-weight: 700;
}

/* Print optimizations */
@media print {
    .thunder-page {
        page-break-before: always;
        break-inside: avoid;
    }
    
    .thunder-stats-table {
        break-inside: auto;
    }
    
    .thunder-details-section {
        break-inside: avoid;
    }
    
    .thunder-movement-section,
    .thunder-release-section {
        break-inside: avoid;
    }
}

/* Ensure glossary prints properly */
@media print {
    .glossary-page {
        page-break-before: always;
        break-inside: avoid;
    }
    
    .glossary-two-column {
        column-count: 2;
        column-gap: 30px;
        column-rule: 2px solid #e2e8f0;
    }
    
    .term-entry {
        break-inside: avoid;
        page-break-inside: avoid;
    }
}

</style>
</head>
<body>
   <div class="player-info">
    <div class="player-info-left">
        <div class="logo-placeholder"></div>
    </div>
    <div class="player-name-group">
        <div class="player-name">{{ pitcher_name }}</div>
        <div class="player-subtitle">
            Trackman Pitching Report
            {% if grad_year %} • Class of {{ grad_year }}{% endif %}
            {% if summary_stats.pitcher_throws %} • {% if summary_stats.pitcher_throws == 'Right' %}RHP{% else %}LHP{% endif %}{% endif %}
        </div>
    </div>
    <div class="player-info-right">
        <div class="date-info">{{ date }}</div>
    </div>
</div>

    {% if summary_stats.comparison_level %}
    <div class="comparison-legend{% if summary_stats.pitch_type_breakdown|length >= 5 %} compact{% endif %}">
        <div class="legend-title{% if summary_stats.pitch_type_breakdown|length >= 5 %} compact{% endif %}">College Baseball Comparison Legend</div>
        <div class="legend-item{% if summary_stats.pitch_type_breakdown|length >= 5 %} compact{% endif %}">
            <span class="legend-indicator above-average{% if summary_stats.pitch_type_breakdown|length >= 5 %} compact{% endif %}"></span>
            Above {{ summary_stats.comparison_level }} Average
        </div>
        <div class="legend-item{% if summary_stats.pitch_type_breakdown|length >= 5 %} compact{% endif %}">
            <span class="legend-indicator below-average{% if summary_stats.pitch_type_breakdown|length >= 5 %} compact{% endif %}"></span>
            Below {{ summary_stats.comparison_level }} Average
        </div>
        <div style="margin-top: {% if summary_stats.pitch_type_breakdown|length >= 5 %}4px{% else %}8px{% endif %}; color: #64748b; font-size: {% if summary_stats.pitch_type_breakdown|length >= 5 %}7px{% else %}9px{% endif %};">
            Player values shown in bold, {{ summary_stats.comparison_level }}{% if summary_stats.pitcher_throws %} {% if summary_stats.pitcher_throws == 'Right' %}RHP{% else %}LHP{% endif %}{% endif %} averages shown below in gray
        </div>
    </div>
    {% endif %}
    
    <div class="summary-section{% if summary_stats.pitch_type_breakdown|length >= 5 %} compact{% endif %}">
        <h2 class="summary-header{% if summary_stats.pitch_type_breakdown|length >= 5 %} compact{% endif %}">Performance Summary{% if summary_stats.comparison_level %} vs {{ summary_stats.comparison_level }}{% if summary_stats.pitcher_throws %} {% if summary_stats.pitcher_throws == 'Right' %}RHP{% else %}LHP{% endif %}{% endif %} College Baseball{% else %} by Pitch Type{% endif %}</h2>
        <div class="stats-container{% if summary_stats.pitch_type_breakdown|length >= 5 %} compact{% endif %}">
            <table class="summary-table{% if summary_stats.pitch_type_breakdown|length >= 5 %} compact{% endif %}">
                <thead>
                    <tr>
                        <th>Pitch Type</th>
                        <th>Count</th>
                        <th>Velocity<br>(mph)</th>
                        <th>Spin Rate<br>(rpm)</th>
                        <th>IVB<br>(in)</th>
                        <th>HB<br>(in)</th>
                        <th>RelSide<br>(ft)</th>
                        <th>RelHeight<br>(ft)</th>
                        <th>Extension<br>(ft)</th>
                    </tr>
                </thead>
                <tbody>
                    {% for pitch_type in summary_stats.pitch_type_breakdown %}
                    <tr>
                        <td class="pitch-type-name">{{ pitch_type.name }}</td>
                        <td class="pitch-count">{{ pitch_type.count }}</td>
                        
                        {% if pitch_type.has_college_data %}
                        <!-- Velocity Comparison -->
                        <td class="metric-value comparison-cell">
                            <span class="player-value">{{ pitch_type.avg_velocity }}</span>
                            <span class="college-value">{{ summary_stats.comparison_level }}{% if summary_stats.pitcher_throws %} {% if summary_stats.pitcher_throws == 'Right' %}RHP{% else %}LHP{% endif %}{% endif %}: {{ pitch_type.college_velocity }}</span>
                            {% if pitch_type.velocity_comp %}
                                <div class="comparison-indicator {% if pitch_type.velocity_comp.better %}above-average{% else %}below-average{% endif %}"></div>
                            {% endif %}
                        </td>
                        
                        <!-- Spin Rate Comparison -->
                        <td class="metric-value comparison-cell">
                            <span class="player-value">{{ pitch_type.avg_spin }}</span>
                            <span class="college-value">{{ summary_stats.comparison_level }}{% if summary_stats.pitcher_throws %} {% if summary_stats.pitcher_throws == 'Right' %}RHP{% else %}LHP{% endif %}{% endif %}: {{ pitch_type.college_spin }}</span>
                            {% if pitch_type.spin_comp %}
                                <div class="comparison-indicator {% if pitch_type.spin_comp.better %}above-average{% else %}below-average{% endif %}"></div>
                            {% endif %}
                        </td>
                        
                        <!-- IVB Comparison -->
                        <td class="metric-value comparison-cell">
                            <span class="player-value">{{ pitch_type.avg_ivb }}</span>
                            <span class="college-value">{{ summary_stats.comparison_level }}{% if summary_stats.pitcher_throws %} {% if summary_stats.pitcher_throws == 'Right' %}RHP{% else %}LHP{% endif %}{% endif %}: {{ pitch_type.college_ivb }}</span>
                            {% if pitch_type.ivb_comp %}
                                <div class="comparison-indicator {% if pitch_type.ivb_comp.better %}above-average{% else %}below-average{% endif %}"></div>
                            {% endif %}
                        </td>
                        
                        <!-- HB Comparison -->
                        <td class="metric-value comparison-cell">
                            <span class="player-value">{{ pitch_type.avg_hb }}</span>
                            <span class="college-value">{{ summary_stats.comparison_level }}{% if summary_stats.pitcher_throws %} {% if summary_stats.pitcher_throws == 'Right' %}RHP{% else %}LHP{% endif %}{% endif %}: {{ pitch_type.college_hb }}</span>
                            {% if pitch_type.hb_comp %}
                                <div class="comparison-indicator {% if pitch_type.hb_comp.better %}above-average{% else %}below-average{% endif %}"></div>
                            {% endif %}
                        </td>
                        
                        <!-- RelSide Comparison -->
                        <td class="metric-value comparison-cell">
    <span class="player-value">{{ pitch_type.avg_rel_side }}</span>
    <span class="college-value">{{ summary_stats.comparison_level }}{% if summary_stats.pitcher_throws %} {% if summary_stats.pitcher_throws == 'Right' %}RHP{% else %}LHP{% endif %}{% endif %}: {{ pitch_type.college_rel_side }}</span>
    <!-- NO comparison indicator div here -->
</td>

<!-- RelHeight Comparison (NO ARROW) -->
<td class="metric-value comparison-cell">
    <span class="player-value">{{ pitch_type.avg_rel_height }}</span>
    <span class="college-value">{{ summary_stats.comparison_level }}{% if summary_stats.pitcher_throws %} {% if summary_stats.pitcher_throws == 'Right' %}RHP{% else %}LHP{% endif %}{% endif %}: {{ pitch_type.college_rel_height }}</span>
    <!-- NO comparison indicator div here -->
</td>

<!-- Extension Comparison (NO ARROW) -->
<td class="metric-value comparison-cell">
    <span class="player-value">{{ pitch_type.avg_extension }}</span>
    <span class="college-value">{{ summary_stats.comparison_level }}{% if summary_stats.pitcher_throws %} {% if summary_stats.pitcher_throws == 'Right' %}RHP{% else %}LHP{% endif %}{% endif %}: {{ pitch_type.college_extension }}</span>
    <!-- NO comparison indicator div here -->
</td>
                        {% else %}
                        <!-- No comparison data available -->
                        <td class="metric-value">{{ pitch_type.avg_velocity }}</td>
                        <td class="metric-value">{{ pitch_type.avg_spin }}</td>
                        <td class="metric-value">{{ pitch_type.avg_ivb }}</td>
                        <td class="metric-value">{{ pitch_type.avg_hb }}</td>
                        <td class="metric-value">{{ pitch_type.avg_rel_side }}</td>
                        <td class="metric-value">{{ pitch_type.avg_rel_height }}</td>
                        <td class="metric-value">{{ pitch_type.avg_extension }}</td>
                        {% endif %}
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    <!-- NEW MOVEMENT PLOT PAGE -->
    {% if movement_plot_svg %}
    <div class="movement-plot-page">
        <div class="movement-plot-header">
            Pitch Movement Analysis
        </div>
        <div class="movement-plot-container">
            <div class="movement-plot-svg">
                {{ movement_plot_svg|safe }}
            </div>
            <div class="movement-plot-description">
                <strong>Understanding These Charts:</strong> The left chart shows how your pitches move - some have "ride" (stay up longer), others have "sink" (drop more), "tail" (break toward your arm), 
                or "cut" (break toward your glove). The up/down movement is called IVB, and side-to-side is HB. The right chart shows where you release the ball. Release point affects how the movement appears to batters.
            </div>
        </div>
    </div>
    {% endif %}

<!-- PITCH LOCATION PAGE WITH ZONE TABLE ONLY -->
{% if pitch_location_plot_svg %}
<!-- Updated HTML structure for the zone table -->
<div class="pitch-location-page">
    <div class="pitch-location-header">
        Pitch Location Analysis
    </div>
    <div class="pitch-location-container">
        <div class="pitch-location-content">
            <!-- LEFT SIDE: STRIKE ZONE PLOT -->
            <div class="pitch-location-plot">
                {{ pitch_location_plot_svg|safe }}
            </div>
            
            <!-- RIGHT SIDE: ZONE RATE TABLE -->
            <div class="pitch-location-info">
                {% if zone_rate_data %}
                <div class="zone-table-container" id="zoneTableContainer">
                    <table class="zone-table-compact" id="zoneTable">
                        <thead>
                            <tr>
                                <th class="pitch-header-compact">Pitch Type</th>
                                <th class="zone-header-compact">Zone %</th>
                                {% if summary_stats.comparison_level %}
                                <th class="college-header-compact">{{ summary_stats.comparison_level }}{% if summary_stats.pitcher_throws %} {% if summary_stats.pitcher_throws == 'Right' %}RHP{% else %}LHP{% endif %}{% endif %}</th>
                                <th class="diff-header-compact">Diff</th>
                                {% endif %}
                                <th class="visual-header-compact">Comp</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Overall row -->
                            <tr class="overall-compact">
                                <td class="pitch-name-compact">
                                    <div class="pitch-label-compact">OVERALL</div>
                                </td>
                                <td class="player-zone-compact">
                                    <div class="zone-pct-compact">{{ "%.1f"|format(zone_rate_data.overall_zone_rate) }}%</div>
                                </td>
                                {% if summary_stats.comparison_level %}
                                <td class="college-zone-compact">
                                    {% if zone_rate_data.overall_college_zone_rate %}
                                    <div class="college-pct-compact">{{ "%.1f"|format(zone_rate_data.overall_college_zone_rate) }}%</div>
                                    {% else %}
                                    <div class="college-pct-compact">N/A</div>
                                    {% endif %}
                                </td>
                                <td class="diff-compact">
                                    {% if zone_rate_data.overall_zone_comparison %}
                                    <div class="diff-value-compact {% if zone_rate_data.overall_zone_comparison.better %}positive-compact{% else %}negative-compact{% endif %}">
                                        {{ "%.1f"|format(zone_rate_data.overall_zone_comparison.difference) }}%
                                    </div>
                                    {% else %}
                                    <div class="diff-value-compact">N/A</div>
                                    {% endif %}
                                </td>
                                {% endif %}
                                <td class="visual-compact">
                                    <div class="comparison-compact">
                                        <div class="bar-compact">
                                            <div class="player-bar-compact" style="width: {{ zone_rate_data.overall_zone_rate }}%"></div>
                                            {% if zone_rate_data.overall_college_zone_rate %}
                                            <div class="college-line-compact" style="left: {{ zone_rate_data.overall_college_zone_rate }}%"></div>
                                            {% endif %}
                                        </div>
                                        {% if zone_rate_data.overall_zone_comparison %}
                                        <div class="arrow-compact {% if zone_rate_data.overall_zone_comparison.better %}arrow-up-compact{% else %}arrow-down-compact{% endif %}"></div>
                                        {% endif %}
                                    </div>
                                </td>
                            </tr>
                            
                            <!-- Individual pitch types -->
                            {% for pitch_type, zone_data in zone_rate_data.pitch_type_zone_rates.items() %}
                            <tr class="pitch-row-compact">
                                <td class="pitch-name-compact">
                                    <div class="pitch-label-compact">{{ pitch_type }}</div>
                                </td>
                                <td class="player-zone-compact">
                                    <div class="zone-pct-compact">{{ "%.1f"|format(zone_data.zone_rate) }}%</div>
                                </td>
                                {% if summary_stats.comparison_level %}
                                <td class="college-zone-compact">
                                    {% if zone_data.college_zone_rate %}
                                    <div class="college-pct-compact">{{ "%.1f"|format(zone_data.college_zone_rate) }}%</div>
                                    {% else %}
                                    <div class="college-pct-compact">N/A</div>
                                    {% endif %}
                                </td>
                                <td class="diff-compact">
                                    {% if zone_data.zone_comparison %}
                                    <div class="diff-value-compact {% if zone_data.zone_comparison.better %}positive-compact{% else %}negative-compact{% endif %}">
                                        {{ "%.1f"|format(zone_data.zone_comparison.difference) }}%
                                    </div>
                                    {% else %}
                                    <div class="diff-value-compact">N/A</div>
                                    {% endif %}
                                </td>
                                {% endif %}
                                <td class="visual-compact">
                                    <div class="comparison-compact">
                                        <div class="bar-compact">
                                            <div class="player-bar-compact" style="width: {{ zone_data.zone_rate }}%"></div>
                                            {% if zone_data.college_zone_rate %}
                                            <div class="college-line-compact" style="left: {{ zone_data.college_zone_rate }}%"></div>
                                            {% endif %}
                                        </div>
                                        {% if zone_data.zone_comparison %}
                                        <div class="arrow-compact {% if zone_data.zone_comparison.better %}arrow-up-compact{% else %}arrow-down-compact{% endif %}"></div>
                                        {% endif %}
                                    </div>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% endif %}
            </div>
        </div>
        <div class="pitch-location-description">
            <strong>Understanding Pitch Location:</strong> This chart shows where each pitch crossed the plate from the pitcher's perspective. 
            The inner rectangle represents the strike zone, while the outer dashed rectangle shows the shadow zone. 
            The zone percentage table shows how often each pitch type was thrown in the strike zone compared to college averages.
        </div>
    </div>
</div>
{% endif %}
    
<!--
    <div class="details-section first-page">
        <h2 class="section-header{% if pitch_data|length > 14 %} compact{% endif %}">Detailed Pitch Analysis</h2>
        <table class="pitch-table{% if pitch_data|length > 14 %} compact{% endif %}">
            <thead>
                <tr>
                    <th>Pitch #</th>
                    <th>Type</th>
                    <th>Velocity<br>(mph)</th>
                    <th>Spin Rate<br>(rpm)</th>
                    <th>Induced Vertical Break<br>(inches)</th>
                    <th>Horizontal Break<br>(inches)</th>
                    <th>Release Height<br>(feet)</th>
                    <th>Release Side<br>(feet)</th>
                </tr>
            </thead>
            <tbody>
                {% for pitch in pitch_data %}
                {% if pitch_data|length <= 20 or loop.index <= 14 %}
                <tr>
                    <td>
                        <div class="pitch-number">{{ loop.index }}</div>
                    </td>
                    <td>
                        <span class="pitch-type">{{ pitch.TaggedPitchType or 'N/A' }}</span>
                    </td>
                    <td>
                        {% if pitch.RelSpeed %}
                            <span class="{% if pitch.RelSpeed > 90 %}velocity-high{% elif pitch.RelSpeed > 82 %}velocity-medium{% else %}velocity-low{% endif %}">
                                {{ "%.1f"|format(pitch.RelSpeed) }}
                            </span>
                        {% else %}
                            N/A
                        {% endif %}
                    </td>                    
                    <td>
                        {% if pitch.SpinRate %}
                            {{ "%.0f"|format(pitch.SpinRate) }}
                        {% else %}
                            N/A
                        {% endif %}
                    </td>
                    <td>
                        {% if pitch.InducedVertBreak %}
                            {{ "%.1f"|format(pitch.InducedVertBreak) }}
                        {% else %}
                            N/A
                        {% endif %}
                    </td>                    
                    <td>
                        {% if pitch.HorzBreak %}
                            {{ "%.1f"|format(pitch.HorzBreak) }}
                        {% else %}
                            N/A
                        {% endif %}
                    </td>                    
                    <td>{{ "%.1f"|format(pitch.RelHeight) if pitch.RelHeight else 'N/A' }}</td>
                    <td>{{ "%.1f"|format(pitch.RelSide) if pitch.RelSide else 'N/A' }}</td>
                </tr>
                {% endif %}
                {% endfor %}
            </tbody>
        </table>
    </div>

    -->
    <!--

    {% if pitch_data|length > 20 %}
    <div style="page-break-before: always;"></div>
    <div class="details-section">
        <h2 class="section-header">Detailed Pitch Analysis (Continued)</h2>
        <table class="pitch-table">
            <thead>
                <tr>
                    <th>Pitch #</th>
                    <th>Type</th>
                    <th>Velocity<br>(mph)</th>
                    <th>Spin Rate<br>(rpm)</th>
                    <th>Induced Vertical Break<br>(inches)</th>
                    <th>Horizontal Break<br>(inches)</th>
                    <th>Release Height<br>(feet)</th>
                    <th>Release Side<br>(feet)</th>
                </tr>
            </thead>
            <tbody>
                {% for pitch in pitch_data %}
                {% if loop.index > 14 %}
                <tr>
                    <td>
                        <div class="pitch-number">{{ loop.index }}</div>
                    </td>
                    <td>
                        <span class="pitch-type">{{ pitch.TaggedPitchType or 'N/A' }}</span>
                    </td>
                    <td>
                        {% if pitch.RelSpeed %}
                            <span class="{% if pitch.RelSpeed > 90 %}velocity-high{% elif pitch.RelSpeed > 82 %}velocity-medium{% else %}velocity-low{% endif %}">
                                {{ "%.1f"|format(pitch.RelSpeed) }}
                            </span>
                        {% else %}
                            N/A
                        {% endif %}
                    </td>
                    <td>
                        {% if pitch.SpinRate %}
                            <span class="{% if pitch.SpinRate > 2200 %}spin-rate-high{% endif %}">
                                {{ "%.0f"|format(pitch.SpinRate) }}
                            </span>
                        {% else %}
                            N/A
                        {% endif %}
                    </td>
                    <td>
                        {% if pitch.InducedVertBreak %}
                            <span class="{% if pitch.InducedVertBreak > 0 %}break-positive{% else %}break-negative{% endif %}">
                                {{ "%.1f"|format(pitch.InducedVertBreak) }}
                            </span>
                        {% else %}
                            N/A
                        {% endif %}
                    </td>
                    <td>
                        {% if pitch.HorzBreak %}
                            <span class="{% if pitch.HorzBreak > 0 %}break-positive{% else %}break-negative{% endif %}">
                                {{ "%.1f"|format(pitch.HorzBreak) }}
                            </span>
                        {% else %}
                            N/A
                        {% endif %}
                    </td>
                    <td>{{ "%.1f"|format(pitch.RelHeight) if pitch.RelHeight else 'N/A' }}</td>
                    <td>{{ "%.1f"|format(pitch.RelSide) if pitch.RelSide else 'N/A' }}</td>
                </tr>
                {% endif %}
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% endif %}
-->
 
<!--
{% if multi_level_stats %}
{% for pitch_type in multi_level_stats %}


{% if not loop.first %}
<div style="page-break-before: always;"></div>
{% endif %}

<div class="details-section" style="margin-top: 0px;">
    <h2 class="section-header">{{ pitch_type.name }} College Level Comparisons (D1, D2, D3)</h2>
    
    <div class="pitch-comparison-card" style="max-width: 100%; margin: 0;">
        <div class="pitch-card-header">
            {{ pitch_type.name }} ({{ pitch_type.count }} pitches)
        </div>
        
        <div class="metrics-grid">

            <div class="metrics-column">
                <div class="metric-comparison">
                    <div class="metric-name">Velocity (mph)</div>
                    <div class="player-value-large">{{ pitch_type.pitcher_velocity }}</div>
                    
                    {% if pitch_type.is_first %}
                    <div class="layout-with-arrow">
                        <div class="level-comparisons">
                            {% for level in ['D1', 'D2', 'D3'] %}
                            <div class="level-badge {% if pitch_type.level_comparisons[level].velocity.comparison %}{% if pitch_type.level_comparisons[level].velocity.comparison.better %}above{% else %}below{% endif %}{% else %}neutral{% endif %}">
                                <div class="level-name">{{ level }}{% if summary_stats.pitcher_throws %} {% if summary_stats.pitcher_throws == 'Right' %}RHP{% else %}LHP{% endif %}{% endif %}</div>
                                <div>{{ pitch_type.level_comparisons[level].velocity.college_avg }}</div>
                                {% if pitch_type.level_comparisons[level].velocity.comparison %}
                                <div class="percentage-diff">{{ pitch_type.level_comparisons[level].velocity.difference }}</div>
                                {% endif %}
                            </div>
                            {% endfor %}
                        </div>
                        <div class="arrow-explanation">
                            <div class="arrow-simple">→</div>
                            <div class="explanation-text">
                                <span class="explanation-label">D3{% if summary_stats.pitcher_throws %} {% if summary_stats.pitcher_throws == 'Right' %}RHP{% else %}LHP{% endif %}{% endif %} = Division Level</span>
                                <span class="explanation-value">{{ pitch_type.level_comparisons['D3'].velocity.college_avg }} = College Average</span>
                                <span class="explanation-value">{{ pitch_type.level_comparisons['D3'].velocity.difference }} = Your Percentile</span>
                            </div>
                        </div>
                    </div>
                    {% else %}
                    <div class="level-comparisons">
                        {% for level in ['D1', 'D2', 'D3'] %}
                        <div class="level-badge {% if pitch_type.level_comparisons[level].velocity.comparison %}{% if pitch_type.level_comparisons[level].velocity.comparison.better %}above{% else %}below{% endif %}{% else %}neutral{% endif %}">
                            <div class="level-name">{{ level }}{% if summary_stats.pitcher_throws %} {% if summary_stats.pitcher_throws == 'Right' %}RHP{% else %}LHP{% endif %}{% endif %}</div>
                            <div>{{ pitch_type.level_comparisons[level].velocity.college_avg }}</div>
                            {% if pitch_type.level_comparisons[level].velocity.comparison %}
                            <div class="percentage-diff">{{ pitch_type.level_comparisons[level].velocity.difference }}</div>
                            {% endif %}
                        </div>
                        {% endfor %}
                    </div>
                    {% endif %}
                </div>
                
                <div class="metric-comparison">
                    <div class="metric-name">Spin Rate (rpm)</div>
                    <div class="player-value-large">{{ pitch_type.pitcher_spin }}</div>
                    <div class="level-comparisons">
                        {% for level in ['D1', 'D2', 'D3'] %}
                        <div class="level-badge {% if pitch_type.level_comparisons[level].spin.comparison %}{% if pitch_type.level_comparisons[level].spin.comparison.better %}above{% else %}below{% endif %}{% else %}neutral{% endif %}">
                            <div class="level-name">{{ level }}{% if summary_stats.pitcher_throws %} {% if summary_stats.pitcher_throws == 'Right' %}RHP{% else %}LHP{% endif %}{% endif %}</div>
                            <div>{{ pitch_type.level_comparisons[level].spin.college_avg }}</div>
                            {% if pitch_type.level_comparisons[level].spin.comparison %}
                            <div class="percentage-diff">{{ pitch_type.level_comparisons[level].spin.difference }}</div>
                            {% endif %}
                        </div>
                        {% endfor %}
                    </div>
                </div>
                
                <div class="metric-comparison">
                    <div class="metric-name">Induced Vertical Break (in)</div>
                    <div class="player-value-large">{{ pitch_type.pitcher_ivb }}</div>
                    <div class="level-comparisons">
                        {% for level in ['D1', 'D2', 'D3'] %}
                        <div class="level-badge {% if pitch_type.level_comparisons[level].ivb.comparison %}{% if pitch_type.level_comparisons[level].ivb.comparison.better %}above{% else %}below{% endif %}{% else %}neutral{% endif %}">
                            <div class="level-name">{{ level }}{% if summary_stats.pitcher_throws %} {% if summary_stats.pitcher_throws == 'Right' %}RHP{% else %}LHP{% endif %}{% endif %}</div>
                            <div>{{ pitch_type.level_comparisons[level].ivb.college_avg }}</div>
                            {% if pitch_type.level_comparisons[level].ivb.comparison %}
                            <div class="percentage-diff">{{ pitch_type.level_comparisons[level].ivb.difference }}</div>
                            {% endif %}
                        </div>
                        {% endfor %}
                    </div>
                </div>
                
                <div class="metric-comparison">
                    <div class="metric-name">Horizontal Break (in)</div>
                    <div class="player-value-large">{{ pitch_type.pitcher_hb }}</div>
                    <div class="level-comparisons">
                        {% for level in ['D1', 'D2', 'D3'] %}
                        <div class="level-badge {% if pitch_type.level_comparisons[level].hb.comparison %}{% if pitch_type.level_comparisons[level].hb.comparison.better %}above{% else %}below{% endif %}{% else %}neutral{% endif %}">
                            <div class="level-name">{{ level }}{% if summary_stats.pitcher_throws %} {% if summary_stats.pitcher_throws == 'Right' %}RHP{% else %}LHP{% endif %}{% endif %}</div>
                            <div>{{ pitch_type.level_comparisons[level].hb.college_avg }}</div>
                            {% if pitch_type.level_comparisons[level].hb.comparison %}
                            <div class="percentage-diff">{{ pitch_type.level_comparisons[level].hb.difference }}</div>
                            {% endif %}
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
            
            <div class="vertical-divider"></div>
            
            <div class="metrics-column">

                <div class="metric-comparison">
                    <div class="metric-name">Max Velocity (mph)</div>
                    <div class="player-value-large">{{ pitch_type.pitcher_max_velocity }}</div>
                    <div class="level-comparisons">
                        {% for level in ['D1', 'D2', 'D3'] %}
                        <div class="level-badge {% if pitch_type.level_comparisons[level].max_velocity.comparison %}{% if pitch_type.level_comparisons[level].max_velocity.comparison.better %}above{% else %}below{% endif %}{% else %}neutral{% endif %}">
                            <div class="level-name">{{ level }}{% if summary_stats.pitcher_throws %} {% if summary_stats.pitcher_throws == 'Right' %}RHP{% else %}LHP{% endif %}{% endif %}</div>
                            <div>{{ pitch_type.level_comparisons[level].max_velocity.college_avg }}</div>
                            {% if pitch_type.level_comparisons[level].max_velocity.comparison %}
                            <div class="percentage-diff">{{ pitch_type.level_comparisons[level].max_velocity.difference }}</div>
                            {% endif %}
                        </div>
                        {% endfor %}
                    </div>
                </div>
                
                <div class="metric-comparison">
                    <div class="metric-name">Release Height (ft)</div>
                    <div class="player-value-large">{{ pitch_type.pitcher_rel_height }}</div>
                    <div class="level-comparisons">
                        {% for level in ['D1', 'D2', 'D3'] %}
                        <div class="level-badge level-badge-static">
                            <div class="level-name">{{ level }}{% if summary_stats.pitcher_throws %} {% if summary_stats.pitcher_throws == 'Right' %}RHP{% else %}LHP{% endif %}{% endif %}</div>
                            <div>{{ pitch_type.level_comparisons[level].rel_height.college_avg }}</div>
                            {% if pitch_type.level_comparisons[level].rel_height.comparison %}
                            <div class="percentage-diff">{{ pitch_type.level_comparisons[level].rel_height.difference }}</div>
                            {% endif %}
                        </div>
                        {% endfor %}
                    </div>
                </div>
                
                <div class="metric-comparison">
                    <div class="metric-name">Release Side (ft)</div>
                    <div class="player-value-large">{{ pitch_type.pitcher_rel_side }}</div>
                    <div class="level-comparisons">
                        {% for level in ['D1', 'D2', 'D3'] %}
                        <div class="level-badge level-badge-static">
                            <div class="level-name">{{ level }}{% if summary_stats.pitcher_throws %} {% if summary_stats.pitcher_throws == 'Right' %}RHP{% else %}LHP{% endif %}{% endif %}</div>
                            <div>{{ pitch_type.level_comparisons[level].rel_side.college_avg }}</div>
                            {% if pitch_type.level_comparisons[level].rel_side.comparison %}
                            <div class="percentage-diff">{{ pitch_type.level_comparisons[level].rel_side.difference }}</div>
                            {% endif %}
                        </div>
                        {% endfor %}
                    </div>
                </div>
                

                <div class="metric-comparison">
                    <div class="metric-name">Extension (ft)</div>
                    <div class="player-value-large">{{ pitch_type.pitcher_extension }}</div>
                    <div class="level-comparisons">
                        {% for level in ['D1', 'D2', 'D3'] %}
                        <div class="level-badge level-badge-static">
                            <div class="level-name">{{ level }}{% if summary_stats.pitcher_throws %} {% if summary_stats.pitcher_throws == 'Right' %}RHP{% else %}LHP{% endif %}{% endif %}</div>
                            <div>{{ pitch_type.level_comparisons[level].extension.college_avg }}</div>
                            {% if pitch_type.level_comparisons[level].extension.comparison %}
                            <div class="percentage-diff">{{ pitch_type.level_comparisons[level].extension.difference }}</div>
                            {% endif %}
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


    
{% endfor %}
{% endif %}
-->

<!-- UPDATED THUNDER SECTION WITH NEW CONTENT -->

{% if thunder_data and thunder_summary %}
<div class="thunder-page">
    <div class="section-header">
        Thunder Analysis
    </div>
    
    <div class="thunder-container">
        <!-- Thunder Explanation -->
        <div class="thunder-explanation-top">
            <div class="thunder-explanation-content">
                <div class="thunder-explanation-text">
                    <h3>Thunder Analysis</h3>
                    <p>Thunder highlights the top 25% of pitches you've thrown—<em>by pitch type</em>—based on their <strong>Stuff+</strong> scores from this specific Trackman session. <strong>Minimum of 3 pitches required</strong> for each pitch type to appear in this analysis.</p>
                </div>
            </div>
        </div>

        <!-- BORDERED Thunder Stats Table with SpinRate -->
        <div class="thunder-stats-section">
            <h3 class="thunder-section-title">Thunder vs Average Performance</h3>
            <div class="thunder-table-container">
                <table class="thunder-stats-table-improved">
                    <thead>
                        <tr>
                            <th>Type</th>
                            <th>Pitch</th>
                            <th>Count</th>
                            <th>Velocity<br>(mph)</th>
                            <th>Spin Rate<br>(rpm)</th>
                            <th>IVB<br>(in)</th>
                            <th>HB<br>(in)</th>
                            <th>Rel Height<br>(ft)</th>
                            <th>Rel Side<br>(ft)</th>
                            <th>Extension<br>(ft)</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for pitch_summary in thunder_summary %}
                        <!-- Average Row -->
                        <tr class="avg-row-improved">
                            <td class="row-type-cell-improved avg-type-improved">Avg</td>
                            <td class="pitch-type-cell-improved">{{ pitch_summary.pitch_type }}</td>
                            <td class="count-cell-improved">{{ pitch_summary.avg_count }}</td>
                            <td class="metric-cell-improved">{{ pitch_summary.avg_velocity }}</td>
                            <td class="metric-cell-improved">{{ pitch_summary.avg_spin_rate }}</td>
                            <td class="metric-cell-improved">{{ pitch_summary.avg_ivb }}</td>
                            <td class="metric-cell-improved">{{ pitch_summary.avg_hb }}</td>
                            <td class="metric-cell-improved">{{ pitch_summary.avg_rel_height }}</td>
                            <td class="metric-cell-improved">{{ pitch_summary.avg_rel_side }}</td>
                            <td class="metric-cell-improved">{{ pitch_summary.avg_extension }}</td>
                        </tr>
                        
                        <!-- Thunder Row -->
                        <tr class="thunder-row-improved">
                            <td class="row-type-cell-improved thunder-type-improved">Thunder</td>
                            <td class="pitch-type-cell-improved thunder-pitch-improved">{{ pitch_summary.pitch_type }}</td>
                            <td class="count-cell-improved thunder-count-improved">{{ pitch_summary.thunder_count }}</td>
                            <td class="metric-cell-improved thunder-metric-improved">{{ pitch_summary.thunder_velocity }}</td>
                            <td class="metric-cell-improved thunder-metric-improved">{{ pitch_summary.thunder_spin_rate }}</td>
                            <td class="metric-cell-improved thunder-metric-improved">{{ pitch_summary.thunder_ivb }}</td>
                            <td class="metric-cell-improved thunder-metric-improved">{{ pitch_summary.thunder_hb }}</td>
                            <td class="metric-cell-improved thunder-metric-improved">{{ pitch_summary.thunder_rel_height }}</td>
                            <td class="metric-cell-improved thunder-metric-improved">{{ pitch_summary.thunder_rel_side }}</td>
                            <td class="metric-cell-improved thunder-metric-improved">{{ pitch_summary.thunder_extension }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Layout with Movement Plot and Understanding sections side by side -->
        <div class="thunder-content-layout">
            <!-- TALLER Movement Plot Section -->
            {% if thunder_movement_plot_svg %}
            <div class="thunder-movement-section-compact">
                <h3 class="thunder-section-title">Movement Profile - Thunder vs Average</h3>
                <div class="thunder-movement-container-compact">
                    {{ thunder_movement_plot_svg|safe }}
                </div>
            </div>
            {% endif %}

            <!-- UPDATED Understanding Thunder Section -->
            <div class="thunder-understanding-section">
                <h3 class="thunder-section-title">Understanding Thunder</h3>
                <div class="thunder-details-content-updated">
                    
                    <div class="thunder-section-block">
                        <h4>What is Thunder?</h4>
                        <p>Thunder highlights the top 25% of pitches you've thrown—<em>by pitch type</em>—based on their <strong>Stuff+</strong> scores from this specific Trackman session.</p>
                    </div>
                    
                    <div class="thunder-section-block">
                        <h4>Understanding Stuff+</h4>
                        <p>Stuff+ measures the physical characteristics of a pitch—velocity, movement, and release point—while removing the influence of pitch location. It isolates how "nasty" or effective a pitch is <em>on its own</em>, independent of where it was thrown or what the batter did.</p>
                    </div>
                    
                    <div class="thunder-section-block">
                        <h4>What Thunder Represents</h4>
                        <p>Your Thunder pitches are the best versions of each pitch type you threw in this session. They represent your highest-quality executions—your top-end stuff. This isn't a theoretical max. It's a data-driven snapshot of what you were capable of today.</p>
                    </div>
                    
                    <div class="thunder-section-block">
                        <h4>Key Benefits</h4>
                        <ul>
                            <li><strong>Performance Benchmark:</strong> Thunder defines your current peak for each pitch type.</li>
                            <li><strong>Consistency Indicator:</strong> The closer your average pitch is to your Thunder pitch, the more reliably you're executing at your highest level.</li>
                            <li><strong>Development Focus:</strong> Provides objective feedback to guide training—what shapes, releases, and velocities to chase.</li>
                        </ul>
                    </div>
                    
                    <div class="thunder-section-block">
                        <h4>How to Use Thunder Data</h4>
                        <p>Look at the gap between your average pitch and your Thunder pitch. A small gap means you're consistently near your best. A larger gap suggests untapped potential—your best stuff is in there, but it's showing up less often.</p>
                    </div>
                    
                    <div class="thunder-section-block">
                        <h4>Requirements</h4>
                        <p>Each pitch type must have at least <strong>4 throws</strong> to be included in Thunder analysis. Pitch types with fewer than 4 are excluded to avoid unreliable conclusions.</p>
                    </div>
                    
                    <div class="thunder-section-block">
                        <h4>Reading the Movement Plot</h4>
                        <ul>
                            <li><strong>Small Circles</strong> = Average movement</li>
                            <li><strong>Large Circles</strong> = Thunder movement</li>
                            <li><strong>Dashed Lines</strong> = The gap between your average and best—your improvement runway</li>
                        </ul>
                    </div>
                    
                </div>
            </div>
        </div>
    </div>
</div>
{% endif %}

<style>
/* BORDERED TABLE CONTAINER */
.thunder-table-container {
    background: white;
    border: 2px solid #e2e8f0;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    margin-bottom: 25px;
}

/* IMPROVED THUNDER TABLE STYLING */
.thunder-stats-table-improved {
    width: 100%;
    border-collapse: collapse;
    margin: 0;
    font-size: 10px;
    border-radius: 0;
    box-shadow: none;
}

.thunder-stats-table-improved th {
    background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
    color: white;
    padding: 12px 8px;
    text-align: center;
    font-weight: 700;
    font-size: 9px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    border: none;
    text-shadow: 0 1px 2px rgba(0,0,0,0.5);
}

.thunder-stats-table-improved td {
    padding: 10px 8px;
    text-align: center;
    border-bottom: 1px solid #f1f5f9;
    font-weight: 500;
}

/* Average Row Styling */
.avg-row-improved {
    background: linear-gradient(135deg, #f8fafc 0%, #ffffff 100%);
}

.avg-row-improved:hover {
    background: #f1f5f9;
}

/* Thunder Row Styling */
.thunder-row-improved {
    background: linear-gradient(135deg, #228B22 0%, #32CD32 100%);
    color: white;
}

.thunder-row-improved td {
    color: white;
    font-weight: 600;
    border-bottom: 1px solid rgba(255,255,255,0.2);
}

.thunder-row-improved:hover {
    background: linear-gradient(135deg, #1e7a1e 0%, #2db82d 100%);
}

/* Cell Type Styling */
.row-type-cell-improved {
    font-weight: 700;
    font-size: 10px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.avg-type-improved {
    color: #475569;
    background: rgba(71,85,105,0.1);
    border-radius: 4px;
    padding: 4px 8px;
}

.thunder-type-improved {
    background: rgba(255,255,255,0.2);
    border-radius: 4px;
    padding: 4px 8px;
}

.pitch-type-cell-improved {
    font-weight: 700;
    font-size: 10px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    background: rgba(26,26,26,0.05);
    border-radius: 4px;
}

.thunder-pitch-improved {
    background: rgba(255,255,255,0.2) !important;
}

.count-cell-improved {
    font-weight: 600;
    color: #6366f1;
    background: rgba(99,102,241,0.1);
    border-radius: 4px;
}

.thunder-count-improved {
    background: rgba(255,255,255,0.2) !important;
    color: white !important;
}

.metric-cell-improved {
    font-weight: 500;
    font-size: 10px;
}

.thunder-metric-improved {
    font-weight: 600;
}

/* LAYOUT FOR MOVEMENT PLOT AND UNDERSTANDING */
.thunder-content-layout {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 30px;
    margin-top: 20px;
}

/* Movement Plot Container */
.thunder-movement-section-compact {
    margin-bottom: 0;
}

.thunder-movement-container-compact {
    background: white;
    border: 2px solid #e2e8f0;
    border-radius: 10px;
    padding: 15px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    text-align: center;
    max-width: 100%;
}

/* UPDATED Understanding Section Styling */
.thunder-understanding-section {
    margin-bottom: 0;
}

.thunder-details-content-updated {
    display: flex;
    flex-direction: column;
    gap: 15px;
    font-size: 9px;
    line-height: 1.4;
}

.thunder-section-block {
    margin-bottom: 12px;
}

.thunder-section-block h4 {
    font-size: 11px;
    font-weight: 700;
    color: #228B22;
    margin: 0 0 6px 0;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.thunder-section-block p {
    margin: 0 0 8px 0;
    color: #475569;
    text-align: justify;
}

.thunder-section-block ul {
    margin: 0;
    padding-left: 12px;
    color: #475569;
}

.thunder-section-block li {
    margin-bottom: 3px;
    line-height: 1.3;
}

.thunder-section-block strong {
    color: #228B22;
    font-weight: 700;
}

.thunder-section-block em {
    font-style: italic;
    color: #1e293b;
}

/* Alternating row colors */
.thunder-stats-table-improved tr:nth-child(even) {
    background: linear-gradient(135deg, #f8fafc 0%, #ffffff 100%);
}

.thunder-stats-table-improved tr:nth-child(odd) {
    background: white;
}

/* Thunder rows override alternating colors */
.thunder-row-improved {
    background: linear-gradient(135deg, #228B22 0%, #32CD32 100%) !important;
}

/* Print optimizations */
@media print {
    .thunder-content-layout {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        break-inside: avoid;
    }
    
    .thunder-movement-section-compact,
    .thunder-understanding-section {
        break-inside: avoid;
    }
    
    .thunder-table-container {
        break-inside: avoid;
    }
    
    .thunder-details-content-updated {
        font-size: 8px;
        line-height: 1.3;
        gap: 10px;
    }
    
    .thunder-section-block h4 {
        font-size: 10px;
        margin-bottom: 4px;
    }
    
    .thunder-section-block {
        margin-bottom: 8px;
    }
}
</style>

<div class="glossary-page">
    <div class="glossary-header">
        Trackman Metrics Glossary
    </div>
    
    <div class="glossary-two-column">
        <div class="term-entry">
            <div class="term-name">Velocity</div>
            <div class="term-definition">The speed of the baseball as it leaves the pitcher's hand, measured by radar technology. This is the raw speed of the pitch and is one of the most fundamental metrics for evaluating pitching performance.</div>
            <div class="term-unit">Measured in miles per hour (mph)</div>
        </div>
        
        <div class="term-entry">
            <div class="term-name">Spin Rate</div>
            <div class="term-definition">The rate at which the baseball rotates around its axis during flight. Higher spin rates generally create more movement and can make fastballs appear to "rise" or breaking balls break more sharply.</div>
            <div class="term-unit">Measured in revolutions per minute (rpm)</div>
        </div>
        
        <div class="term-entry">
            <div class="term-name">Induced Vertical Break</div>
            <div class="term-definition">The vertical movement of the pitch due to spin, measured against the effect of gravity alone. Positive values indicate the ball stays up longer than gravity would allow, while negative values show the ball drops more than expected.</div>
            <div class="term-unit">Measured in inches (in)</div>
        </div>
        
        <div class="term-entry">
            <div class="term-name">Horizontal Break</div>
            <div class="term-definition">The horizontal movement of the pitch from the pitcher's perspective due to spin and arm angle. Positive values represent movement toward the pitcher's arm side, while negative values show movement toward the glove side.</div>
            <div class="term-unit">Measured in inches (in)</div>
        </div>
        
        <div class="term-entry">
            <div class="term-name">Release Height</div>
            <div class="term-definition">The vertical distance from the ground to the ball at the point of release from the pitcher's hand. Taller pitchers typically have higher release points, which can create a steeper angle to the plate.</div>
            <div class="term-unit">Measured in feet (ft)</div>
        </div>
        
        <div class="term-entry">
            <div class="term-name">Release Side</div>
            <div class="term-definition">The horizontal distance from the center of the pitcher's mound to the release point of the ball. This measurement indicates how far left or right the pitcher releases the ball relative to the rubber.</div>
            <div class="term-unit">Measured in feet (ft)</div>
        </div>
        
        <div class="term-entry">
            <div class="term-name">Extension</div>
            <div class="term-definition">How far toward home plate the pitcher releases the ball beyond the front of the rubber. Greater extension effectively shortens the distance to the batter and can make pitches appear faster.</div>
            <div class="term-unit">Measured in feet (ft)</div>
        </div>
        
        <div class="term-entry">
            <div class="term-name">Max Velocity</div>
            <div class="term-definition">The highest velocity recorded for a specific pitch type during the session. This represents the pitcher's peak performance for that particular pitch and is often used to evaluate power potential.</div>
            <div class="term-unit">Measured in miles per hour (mph)</div>
        </div>
        
        <div class="term-entry">
            <div class="term-name">Percentile Ranking</div>
            <div class="term-definition">A statistical measure showing what percentage of college pitchers the player performs better than in each metric. A 75th percentile ranking means the player performs better than 75% of college pitchers at that level.</div>
            <div class="term-unit">Expressed as a percentage (%)</div>
        </div>
        
        <div class="term-entry">
            <div class="term-name">Strike Zone</div>
            <div class="term-definition">The three-dimensional area over home plate between the batter's knees and chest. Trackman technology precisely measures pitch location relative to this zone to calculate strike percentages and command metrics.</div>
            <div class="term-unit">Defined in feet and inches</div>
        </div>
    </div>
</div>
<script>
    // JavaScript to dynamically adjust table sizing based on number of pitch types
    document.addEventListener('DOMContentLoaded', function() {
        const tableContainer = document.getElementById('zoneTableContainer');
        const table = document.getElementById('zoneTable');
        
        if (tableContainer && table) {
            const rows = table.querySelectorAll('tbody tr');
            const rowCount = rows.length;
            
            // Remove existing classes
            tableContainer.classList.remove('few-pitches', 'normal-pitches', 'many-pitches');
            table.classList.remove('few-rows', 'normal-rows', 'many-rows');
            
            // Add appropriate classes based on row count
            if (rowCount <= 3) {
                tableContainer.classList.add('few-pitches');
                table.classList.add('few-rows');
            } else if (rowCount <= 5) {
                tableContainer.classList.add('normal-pitches');
                table.classList.add('normal-rows');
            } else {
                tableContainer.classList.add('many-pitches');
                table.classList.add('many-rows');
            }
        }
    });
    </script>


<div class="footer">
  <img src="static/pbr.png" alt="PBR Logo" class="footer-logo">
  <span class="footer-text">{{ pitcher_name }}</span>
  <span class="footer-date">{{ date }}</span>
</div>

</body>
</html>